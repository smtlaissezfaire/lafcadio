#!/usr/bin/env ruby

require 'lafcadio/schema'
require 'lafcadio/util'
require 'getoptlong'
include Lafcadio

opts = GetoptLong.new( [ '--config', '-c', GetoptLong::REQUIRED_ARGUMENT ] )
if ( ( optArray = opts.get ) && ARGV.size >= 1 )
	configFile = optArray[1]
	LafcadioConfig.set_filename( configFile )
	ARGV.each { |fileName|
		require "#{ fileName }"
		fileName =~ /(\w*)\.rb/
		className = $1
		domainClass = Class.getClass( className )
		if domainClass
			statement = CreateTableStatement.new( domainClass )
			puts statement.toSql
		else
			puts "No domain class in #{ fileName }"
		end
	}
else
	puts "lafcadio_schema -c config domain1.rb {, domain2.rb, domain3.rb ... }"
end